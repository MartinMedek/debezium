apiVersion: v1
kind: Pod
metadata:
  name: "testsuite"
  namespace: debezium-mmedek-testsuite
spec:
  restartPolicy: Never
  volumes:
    - name: testsuite-volume
      persistentVolumeClaim:
        claimName: testsuite-storage-claim
  containers:
    - name: "dbz-testing-system"
      image: quay.io/mmedek/testsuite:latest
      imagePullPolicy: Always
      ports:
        - containerPort: 9000
          protocol: "TCP"
      volumeMounts:
        - mountPath: /root/.m2
          name: testsuite-volume
      env:
        - name: TESTSUITE_ARGUMENTS
          value: >
            -Ddatabase.mongo.use.keyfile=false
            -Docp.username="debezium" 
            -Dstrimzi.kc.log.level.dbz="WARN" 
            -Docp.password="GreenPanda48" 
            -Docp.url="https://api.mmedek.debezium.app-services-dev.net:6443" 
            -Docp.project.debezium="debezium-mmedek" 
            -Dprepare.strimzi=false 
            -DskipTests=true 
            -Dversion.strimzi.kafka=3.6.0 
            -Dtest.wait.scale=2 
            -Dimage.as=quay.io/rh_integration/dbz-artifact-server-downstream:2.5.2.CR1  
            -Dgroups="mongo-sharded&!avro&openshift"
        - name: DBZ_GIT_BRANCH
          value: "ssl-poc"
        - name: DBZ_GIT_REPOSITORY
          value: "https://github.com/martinmedek/debezium.git"
        - name: DBZ_OCP_PROJECT_DEBEZIUM  
          value: "debezium-mmedek"
        - name: DBZ_SECRET_NAME
          value: "mmedek-pull-secret"
